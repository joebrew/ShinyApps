{
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n\nlibrary(shiny)\n\nshinyServer(function(input, output) {\n  #setwd(\"C:/Users/BrewJR/Documents/ShinyApps/aftercare\")\n  source(\"helper.R\")\n\n  output$plot1 <- renderPlot({\n    \n    teacherPay <- input$teacher\n    studentCost <- input$student\n    \n    for (i in ts$day){\n      for (j in c(30,60,90,120)){\n        income <- Hourfy(ts[which(ts$day == i),paste0(\"x\", j)])*studentCost\n        expense <- Hourfy(j)*teacherPay\n        roi <- income - expense\n        \n        ts[which(ts$day == i), paste0(\"roi\", j)] <- roi\n        \n        \n      }\n    }\n    \n    ts2 <- ts[, grepl(\"roi|day\", colnames(ts))]\n    \n    \n    colnames(ts2) <- c(\"day\", \"3:30\", \"4:00\", \"4:30\", \"5:00\")\n    ts2\n    \n    \n    PlotFun <- function(day){\n      num <- as.numeric(ts2[which(ts$day == day),2:5])\n      bp <- barplot(num,\n                    names.arg= c(\"3:30\", \"4:00\", \"4:30\", \"5:00\"),\n                    main=day,\n                    cex.axis =0.6)\n      text(bp[,1], \n           y = num,\n           pos = ifelse(num > 0,1,3),\n           labels= num)\n      abline(h=0)\n    }\n    \n    par(mfrow=c(5,1))\n    par(mar=c(4,4,1,1))\n    for (i in days){\n      PlotFun(i)\n    }\n\n  })\n\n  output$plot2 <- renderPlot({\n    barplot(1:10)\n  })\n  \n  output$table1 <- renderTable({\n    \n    teacherPay <- input$teacher\n    studentCost <- input$student\n    \n    for (i in ts$day){\n      for (j in c(30,60,90,120)){\n        income <- Hourfy(ts[which(ts$day == i),paste0(\"x\", j)])*studentCost\n        expense <- Hourfy(j)*teacherPay\n        roi <- income - expense\n        \n        ts[which(ts$day == i), paste0(\"roi\", j)] <- roi\n        \n        \n      }\n    }\n    \n    ts2 <- ts[, grepl(\"roi|day\", colnames(ts))]\n    colnames(ts2) <- c(\"day\", \"3:30\", \"4:00\", \"4:30\", \"5:00\")\n    \n    ts2\n    \n  })\n  \n    \n  \n})\n",
    "created" : 1410303343547.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3210218175",
    "id" : "4E1FBD09",
    "lastKnownWriteTime" : 1410316347,
    "path" : "~/shinyapps/aftercare/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}