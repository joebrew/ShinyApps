mycols <- adjustcolor(mycols, alpha.f=0.4)
for (i in seq(30,70,1)){
points(seq(0,11,0.01), seq(1,1.04,length=length(seq(0,11,0.01)))^i,
pch=16,
cex=0.2,
#cex=seq(3,0, length= length(seq(0,11,0.1))),
col=mycols)
}
par(mar=c(5,4,4,1))
par(oma=c(1,1,3,1))
par(mfrow=c(2,3))
GradeFun(school, 2011, bar=TRUE)
GradeFun(school, 2012, bar=TRUE)
GradeFun(school, 2013, bar=TRUE)
ScatterFun(school, 2011)
title(main = "Consent form return and immunization rate (2011)", cex.main=0.9)
ScatterFun(school, 2012)
title(main = "Consent form return and immunization rate (2012)", cex.main=0.9)
ScatterFun(school, 2013)
title(main = "Consent form return and immunization rate (2013)", cex.main=0.9)
#title(main= school, outer=TRUE, line = -0.5)
par(mfrow=c(2,3))
LunchFun(school, 2011)
LunchFun(school, 2012)
LunchFun(school, 2013)
GradeFun(school, bar=FALSE)
dev.off()
}
PacketFun("LITTLEWOOD ELEM.")
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
setwd("C:/Users/BrewJR/Documents/ShinyApps/controlfluteams")
#######################
# ATTACH LIBRARIES
#######################
library(RCurl)
library(RColorBrewer)
suppressPackageStartupMessages(library(googleVis))
#######################
# SOURCE HELPER
#######################
source("helper.R")
#######################
# WRITE CODE FOR PACKETS
#######################
PacketFun <- function(school){
setwd("C:/Users/BrewJR/Documents/fdoh/public/controlflu2014")
pdf(file = paste0(school, ".pdf"), width = 11, height = 8.5)
par(mar=c(5,5,5,5))
par(oma=c(5,5,5,5))
par(mfrow=c(1,1))
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0(school), cex = 3,  pos = 3 )
text(x=5.5, y = 6.5, labels = paste0("Control Flu"), cex = 2,  pos = 3 )
text(x=5.5, y = 5.5, labels = "Data packet", cex = 2,  pos = 3 )
text(x=5.5, y = 4.5, labels = paste0("Team ", ir$team2014[which(ir$school == school)][1]), cex = 2,  pos = 3 )
mycols <- colorRampPalette(brewer.pal(8, "Dark2"))(length(seq(0,11,0.01)))
mycols <- adjustcolor(mycols, alpha.f=0.4)
for (i in seq(30,70,1)){
points(seq(0,11,0.01), seq(1,1.04,length=length(seq(0,11,0.01)))^i,
pch=16,
cex=0.2,
#cex=seq(3,0, length= length(seq(0,11,0.1))),
col=mycols)
}
par(mar=c(5,4,4,1))
par(oma=c(1,1,3,1))
par(mfrow=c(2,3))
GradeFun(school, 2011, bar=TRUE)
GradeFun(school, 2012, bar=TRUE)
GradeFun(school, 2013, bar=TRUE)
ScatterFun(school, 2011)
title(main = "Consent form return and immunization rate (2011)", cex.main=0.9)
ScatterFun(school, 2012)
title(main = "Consent form return and immunization rate (2012)", cex.main=0.9)
ScatterFun(school, 2013)
title(main = "Consent form return and immunization rate (2013)", cex.main=0.9)
#title(main= school, outer=TRUE, line = -0.5)
par(mfrow=c(2,3))
LunchFun(school, 2011)
LunchFun(school, 2012)
LunchFun(school, 2013)
GradeFun(school, bar=FALSE)
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0("Prepared by FDOH - Alachua County"), cex = 3,  pos = 3 )
dev.off()
}
PacketFun("LITTLEWOOD ELEM.")
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
setwd("C:/Users/BrewJR/Documents/ShinyApps/controlfluteams")
#######################
# ATTACH LIBRARIES
#######################
library(RCurl)
library(RColorBrewer)
suppressPackageStartupMessages(library(googleVis))
#######################
# SOURCE HELPER
#######################
source("helper.R")
#######################
# WRITE CODE FOR PACKETS
#######################
PacketFun <- function(school){
setwd("C:/Users/BrewJR/Documents/fdoh/public/controlflu2014")
pdf(file = paste0(school, ".pdf"), width = 11, height = 8.5)
par(mar=c(5,5,5,5))
par(oma=c(5,5,5,5))
par(mfrow=c(1,1))
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0(school), cex = 3,  pos = 3 )
text(x=5.5, y = 6.5, labels = paste0("Control Flu"), cex = 2,  pos = 3 )
text(x=5.5, y = 5.5, labels = "Data packet", cex = 2,  pos = 3 )
text(x=5.5, y = 4.5, labels = paste0("Team ", ir$team2014[which(ir$school == school)][1]), cex = 2,  pos = 3 )
mycols <- colorRampPalette(brewer.pal(8, "Dark2"))(length(seq(0,11,0.01)))
mycols <- adjustcolor(mycols, alpha.f=0.4)
for (i in seq(30,70,1)){
points(seq(0,11,0.01), seq(1,1.04,length=length(seq(0,11,0.01)))^i,
pch=16,
cex=0.2,
#cex=seq(3,0, length= length(seq(0,11,0.1))),
col=mycols)
}
par(mar=c(5,4,4,1))
par(oma=c(1,1,3,1))
par(mfrow=c(2,3))
GradeFun(school, 2011, bar=TRUE)
GradeFun(school, 2012, bar=TRUE)
GradeFun(school, 2013, bar=TRUE)
ScatterFun(school, 2011)
title(main = "Consent form return and immunization rate (2011)", cex.main=0.9)
ScatterFun(school, 2012)
title(main = "Consent form return and immunization rate (2012)", cex.main=0.9)
ScatterFun(school, 2013)
title(main = "Consent form return and immunization rate (2013)", cex.main=0.9)
#title(main= school, outer=TRUE, line = -0.5)
par(mfrow=c(2,3))
LunchFun(school, 2011)
LunchFun(school, 2012)
LunchFun(school, 2013)
GradeFun(school, bar=FALSE)
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0("Prepared by FDOH - Alachua County"), cex = 1,  pos = 3 )
dev.off()
}
PacketFun("LITTLEWOOD ELEM.")
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
setwd("C:/Users/BrewJR/Documents/ShinyApps/controlfluteams")
#######################
# ATTACH LIBRARIES
#######################
library(RCurl)
library(RColorBrewer)
suppressPackageStartupMessages(library(googleVis))
#######################
# SOURCE HELPER
#######################
source("helper.R")
#######################
# WRITE CODE FOR PACKETS
#######################
PacketFun <- function(school){
setwd("C:/Users/BrewJR/Documents/fdoh/public/controlflu2014")
pdf(file = paste0(school, ".pdf"), width = 11, height = 8.5)
par(mar=c(5,5,5,5))
par(oma=c(5,5,5,5))
par(mfrow=c(1,1))
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0(school), cex = 3,  pos = 3 )
text(x=5.5, y = 6.5, labels = paste0("Control Flu"), cex = 2,  pos = 3 )
text(x=5.5, y = 5.5, labels = "Data packet", cex = 2,  pos = 3 )
text(x=5.5, y = 4.5, labels = paste0("Team ", ir$team2014[which(ir$school == school)][1]), cex = 2,  pos = 3 )
mycols <- colorRampPalette(brewer.pal(8, "Dark2"))(length(seq(0,11,0.01)))
mycols <- adjustcolor(mycols, alpha.f=0.4)
for (i in seq(30,70,1)){
points(seq(0,11,0.01), seq(1,1.04,length=length(seq(0,11,0.01)))^i,
pch=16,
cex=0.2,
#cex=seq(3,0, length= length(seq(0,11,0.1))),
col=mycols)
}
par(mar=c(5,4,4,1))
par(oma=c(1,1,3,1))
par(mfrow=c(2,3))
GradeFun(school, 2011, bar=TRUE)
GradeFun(school, 2012, bar=TRUE)
GradeFun(school, 2013, bar=TRUE)
ScatterFun(school, 2011)
title(main = "Consent form return and immunization rate (2011)", cex.main=0.9)
ScatterFun(school, 2012)
title(main = "Consent form return and immunization rate (2012)", cex.main=0.9)
ScatterFun(school, 2013)
title(main = "Consent form return and immunization rate (2013)", cex.main=0.9)
#title(main= school, outer=TRUE, line = -0.5)
par(mfrow=c(2,3))
LunchFun(school, 2011)
LunchFun(school, 2012)
LunchFun(school, 2013)
GradeFun(school, bar=FALSE)
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0("Details"), cex = 2,  pos = 3 )
text(x=5.5, y = 6, labels = paste0("Prepared by FDOH - Alachua County"), cex = 1,  pos = 3 )
text(x=5.5, y = 5, labels = paste0("Joseph.Brew@flhealth.gov"), cex = 1,  pos = 3 )
dev.off()
}
PacketFun("LITTLEWOOD ELEM.")
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
setwd("C:/Users/BrewJR/Documents/ShinyApps/controlfluteams")
#######################
# ATTACH LIBRARIES
#######################
library(RCurl)
library(RColorBrewer)
suppressPackageStartupMessages(library(googleVis))
#######################
# SOURCE HELPER
#######################
source("helper.R")
#######################
# WRITE CODE FOR PACKETS
#######################
PacketFun <- function(school){
setwd("C:/Users/BrewJR/Documents/fdoh/public/controlflu2014")
pdf(file = paste0(school, ".pdf"), width = 11, height = 8.5)
par(mar=c(5,5,5,5))
par(oma=c(5,5,5,5))
par(mfrow=c(1,1))
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0(school), cex = 3,  pos = 3 )
text(x=5.5, y = 6.5, labels = paste0("Control Flu"), cex = 2,  pos = 3 )
text(x=5.5, y = 5.5, labels = "Data packet", cex = 2,  pos = 3 )
text(x=5.5, y = 4.5, labels = paste0("Team ", ir$team2014[which(ir$school == school)][1]), cex = 2,  pos = 3 )
mycols <- colorRampPalette(brewer.pal(8, "Dark2"))(length(seq(0,11,0.01)))
mycols <- adjustcolor(mycols, alpha.f=0.4)
for (i in seq(30,70,1)){
points(seq(0,11,0.01), seq(1,1.04,length=length(seq(0,11,0.01)))^i,
pch=16,
cex=0.2,
#cex=seq(3,0, length= length(seq(0,11,0.1))),
col=mycols)
}
par(mar=c(5,4,4,1))
par(oma=c(1,1,3,1))
par(mfrow=c(2,3))
ScatterFun(school, 2011)
title(main = "Consent form return and immunization rate (2011)", cex.main=0.9)
ScatterFun(school, 2012)
title(main = "Consent form return and immunization rate (2012)", cex.main=0.9)
ScatterFun(school, 2013)
title(main = "Consent form return and immunization rate (2013)", cex.main=0.9)
GradeFun(school, 2011, bar=TRUE)
GradeFun(school, 2012, bar=TRUE)
GradeFun(school, 2013, bar=TRUE)
#title(main= school, outer=TRUE, line = -0.5)
par(mfrow=c(2,3))
LunchFun(school, 2011)
LunchFun(school, 2012)
LunchFun(school, 2013)
GradeFun(school, bar=FALSE)
plot(1:10, 1:10, type = "n", xaxt = "n", yaxt = "n", xlab=NA, ylab = NA)
text(x=5.5, y = 8, labels = paste0("Details"), cex = 2,  pos = 3 )
text(x=5.5, y = 6, labels = paste0("Prepared by FDOH - Alachua County"), cex = 1,  pos = 3 )
text(x=5.5, y = 5, labels = paste0("Joseph.Brew@flhealth.gov"), cex = 1,  pos = 3 )
dev.off()
}
PacketFun("LITTLEWOOD ELEM.")
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
#######################
#
#######################
for (i in unique(sort(ir$school))){
PacketFun(i)
}
for (i in unique(sort(ir$school))){
ScatterFun(i)
}
ScatterFun("A QUINN ELEM.")
ScatterFun
ScatterFun("A QUINN ELEM.")
for (i in unique(sort(ir$school))){
ScatterFun(i)
}
for (i in unique(sort(ir$school))){
ScatterFun(i)
}
ScatterFun("NEWBERRY ELEM.")
ScatterFun("GLEN SPRINGS ELEM.")
SCATTERFUN("LITTLEWOOD ELEM.")
PacketFun("GLEN SPRINGS ELEM.")
PacketFun("GLEN SPRINGS ELEM.")
unique(sort(ir$school))
for (i in unique(sort(ir$school[which(!is.na(ir$team2014))]))){
ScatterFun(i)
}
PacketFun(unique(sort(ir$school))[1])
PacketFun(unique(sort(ir$school))[2])
PacketFun(unique(sort(ir$school))[3])
PacketFun(unique(sort(ir$school))[4])
PacketFun(unique(sort(ir$school))[5])
GradeFun(unique(sort(ir$school))[5])
GradeFun(unique(sort(ir$school))[5], year = 2012)
PacketFun(unique(sort(ir$school))[6])
PacketFun(unique(sort(ir$school))[7])
PacketFun(unique(sort(ir$school))[8])
PacketFun(unique(sort(ir$school[which(!is.na(ir$team2014))]))[1])
unique(sort(ir$school[which(!is.na(ir$team2014))]))
PacketFun(unique(sort(ir$school[which(!is.na(ir$team2014))]))[2])
PacketFun(unique(sort(ir$school[which(!is.na(ir$team2014))]))[3])
PacketFun(unique(sort(ir$school[which(!is.na(ir$team2014))]))[4])
ir$cfrr[which(ir$school == "BUCCHOLZ HIGH.")]
ir$cfrr[which(ir$school == "BUCHHOLZ HIGH.")]
ir$cfrr[which(ir$school == "BUCHHOLZ HIGH")]
#######################
# FUNCTION FOR PLOTTING BY GRADE
#######################
GradeFun <- function(school, year, bar=TRUE){
grades <- c(".1", 0:12)
gradecols <- colorRampPalette(brewer.pal(8, "Dark2"))(length(grades))
gradecols <- adjustcolor(gradecols, alpha.f=0.7)
if(!bar){
#par(mfrow=c(1,2))
par(mar=c(4,4,0,0))
plot(2006:2013, 2006:2013,
type="n", ylim=c(0,100), xlim=c(2011,2013),
xlab= NA, ylab= "Immunization rate",
xaxt="n", cex.axis=1.5)
text(x=2012, y = 15, labels=paste0("Immunization rate "),
cex=1.5)
text(x= 2012, y = 5, labels = paste0( "(", school, ")"))
axis(side=1, at=2011:2013, labels=2011:2013)
for (i in 1:length(grades)){
myVals <- as.numeric(as.character(ir[which(ir$school == school), paste0("immRate_grade", grades[i])]))
myYears <- as.numeric(as.character(ir$year[which(ir$school == school)]))
myPoints <- 12:25
lines(myYears, myVals, type = "l", col=gradecols[i])
points(myYears, myVals, col=gradecols[i],pch=myPoints)
}
legend(x="topleft", col=gradecols, lty=1,
legend=c("Pre-K", "K", grades[-c(1,2)]), ncol=2,
border=FALSE, bty="n", pch=myPoints, cex=1)
par(mar=c(4,4,0,0))
plot(2006:2013, 2006:2013,
type="n", ylim=c(0,100), xlim=c(2011,2013),
xlab= NA, ylab= "Consent form return rate", xaxt="n",
cex.axis=1.5)
text(x=2012, y = 15, labels=paste0("Consent form return rate "),
cex=1.5)
text(x= 2012, y = 5, labels = paste0( "(", school, ")"))
axis(side=1, at=2011:2013, labels=2011:2013)
for (i in 1:length(grades)){
myVals <- as.numeric(as.character(ir[which(ir$school == school), paste0("cfrr_grade", grades[i])]))
myYears <- as.numeric(as.character(ir$year[which(ir$school == school)]))
lines(myYears, myVals,  lty = 1, col=gradecols[i])
points(myYears, myVals, col=gradecols[i], pch=myPoints)
}
}else{
#par(mfrow=c(1,1))
tempVals <- vector(length=length(grades), mode="numeric")
tempImm <- vector(length=length(grades), mode="numeric")
for (i in 1:length(grades)){
tempVals[i] <- as.numeric(as.character(ir[which(ir$school == school &
ir$year == year),
paste0("cfrr_grade", grades[i])]))
tempImm[i] <- as.numeric(as.character(ir[which(ir$school == school &
ir$year == year),
paste0("immRate_grade", grades[i])]))
}
grades[which(grades == ".1")] <- "Pre-K"
grades[which(grades == 0)] <- "K"
if(length(tempVals[which(!is.na(tempVals))]]) > 0){
bp <- barplot(tempVals[which(!is.na(tempVals))],
names.arg=grades[which(!is.na(tempVals))],
border=NA, ylim=c(0,100), ylab="Percentage",
xlab="Grade",
main = paste0(school, " (", year, ")"))
barplot(tempImm[which(!is.na(tempImm))],
col=adjustcolor("blue", alpha.f=0.4), add=TRUE,
border=NA)
text(bp[,1], tempVals[which(!is.na(tempVals))], pos=1,
labels=round(tempVals[which(!is.na(tempVals))], digits=2),
col = adjustcolor("black", alpha.f=0.7))
text(bp[,1], tempImm[which(!is.na(tempImm))], pos=1,
labels=round(tempImm[which(!is.na(tempImm))], digits=2),
col = adjustcolor("black", alpha.f=0.7))
legend(x="topleft",
fill=adjustcolor(c("black", "blue"), alpha.f=0.7),
legend=c("CFRR", "IR"), bty= "n", border = FALSE, cex=0.75)
}
}
}
#GradeFun("LITTLEWOOD ELEM.", 2011, bar=FALSE)
######################
# FREE REDUCED LUNCH FUN
######################
LunchFun <- function(school, year=2013){
# THIS DOES ONLY 2013
type <- ir$type[which(ir$school == school)][1]
frl <- ir$frLunch13[which(ir$school != school & ir$year == year
& ir$type == type)]
cfrr <-  ir$cfrr[which(ir$school != school & ir$year == year &
ir$type == type)]
frl_school <- ir$frLunch13[which(ir$school == school & ir$year == year)]
cfrr_school <-  ir$cfrr[which(ir$school == school & ir$year == year)]
schoolcol <- adjustcolor("darkred", alpha.f=0.6)
othercol <- adjustcolor("black", alpha.f=0.3)
plot(0:100, 0:100,
xlab = "Percent free/reduced lunch",
ylab = "Consent form return rate",
main = paste0("Free/reduced lunch and CFRR (", year, ")"),
xlim=c(0,100),
ylim=c(0,100))
points(frl, cfrr, col=othercol, pch=16, cex = 2)
points(frl_school, cfrr_school, pch=16, col=schoolcol, cex=3)
legend(x="bottomleft",
pt.cex=c(2,3),
pch=16,
col=c(othercol, schoolcol),
legend=c(paste0(school, " (", year, ")"),
paste0("Other ", type, " schools (", year, ")")),
cex=0.8)
}
LunchFun("LITTLEWOOD ELEM.", 2013)
dev.off()
LunchFun("LITTLEWOOD ELEM.", 2013)
plot(0:100, 0:100,
xlab = "Percent free/reduced lunch",
ylab = "Consent form return rate",
main = paste0("Free/reduced lunch and CFRR (", year, ")"),
xlim=c(0,100),
ylim=c(0,100))
LunchFun("LITTLEWOOD ELEM.", 2013)
